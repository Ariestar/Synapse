<div 
    class="fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:block"
    :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'"
    @click.outside="if(window.innerWidth < 1024) sidebarOpen = false"
>
    <!-- Header -->
    <div class="h-16 flex items-center justify-between px-6 border-b border-gray-100">
        <span class="font-bold text-lg text-black tracking-tight">KingStudy</span>
        <button class="lg:hidden text-gray-500 hover:text-gray-900" @click="sidebarOpen = false">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="p-4 space-y-1">
        <a href="/home.html" class="flex items-center px-4 py-2 text-sm font-medium rounded-md group transition-colors {{ 'bg-gray-100 text-black' if request.path == '/home.html' or request.path == '/' else 'text-gray-600 hover:bg-gray-50 hover:text-black' }}">
            <span class="mr-3 text-lg">ğŸ </span> é¦–é¡µ
        </a>
        <a href="/aichat.html" class="flex items-center px-4 py-2 text-sm font-medium rounded-md group transition-colors {{ 'bg-gray-100 text-black' if request.path == '/aichat.html' else 'text-gray-600 hover:bg-gray-50 hover:text-black' }}">
            <span class="mr-3 text-lg">ğŸ’¬</span> ChatBox
        </a>
        <a href="/notes.html" class="flex items-center px-4 py-2 text-sm font-medium rounded-md group transition-colors {{ 'bg-gray-100 text-black' if request.path == '/notes.html' else 'text-gray-600 hover:bg-gray-50 hover:text-black' }}">
            <span class="mr-3 text-lg">ğŸ“</span> ç¬”è®°æœ¬
        </a>
    </nav>

    <!-- Tools Section -->
    <div class="mt-8 px-4">
        <h3 class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">å·¥å…·</h3>
        <div class="space-y-1">
            <button @click="settingsOpen = true" class="w-full flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-black transition-colors">
                <span class="mr-3 text-lg">âš™ï¸</span> API é…ç½®
            </button>
            <button @click="$dispatch('open-rag-search')" class="w-full flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-black transition-colors">
                <span class="mr-3 text-lg">ğŸ”</span> æœç´¢ç¬”è®°
            </button>
        </div>
    </div>

    <!-- Footer -->
    <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-100 bg-gray-50/50">
        {% if '/notes' in request.path %}
        <button @click="$dispatch('open-new-note')" class="w-full flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-black hover:bg-gray-800 focus:outline-none shadow-sm transition-all">
            + æ–°å»ºç¬”è®°
        </button>
        {% elif '/aichat.html' in request.path %}
        <button @click="createNewChat ? createNewChat() : window.location.reload()" class="w-full flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-black hover:bg-gray-800 focus:outline-none shadow-sm transition-all">
            + å¼€å§‹æ–°å¯¹è¯
        </button>
        {% else %}
        <a href="/aichat.html" class="w-full flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-black hover:bg-gray-800 focus:outline-none shadow-sm transition-all">
            + å¼€å§‹æ–°å¯¹è¯
        </a>
        {% endif %}
    </div>
</div>

<!-- Mobile Overlay -->
<div 
    class="fixed inset-0 bg-gray-900/50 z-40 lg:hidden"
    x-show="sidebarOpen"
    x-transition.opacity
    @click="sidebarOpen = false"
    style="display: none;"
    x-cloak
></div>




